{"version":3,"names":["path","_interopRequireWildcard","require","_webpack","data","_util","_BaseTarget","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","MainTarget","BaseTarget","constructor","configureRules","configurator","rules","push","test","use","loader","options","configureFileLoader","configurePlugins","isProduction","plugins","DefinePlugin","__static","staticSourceDirectory","entryFiles","join","__dirname","devIndexFile","getFirstExistingFile","projectDir"],"sources":["../../src/targets/MainTarget.ts"],"sourcesContent":["import * as path from \"path\"\r\n// import { BannerPlugin, DefinePlugin } from \"webpack\"\r\nimport { DefinePlugin } from \"webpack\"\r\nimport { WebpackConfigurator } from \"../main\"\r\nimport { getFirstExistingFile } from \"../util\"\r\nimport { BaseTarget, configureFileLoader } from \"./BaseTarget\"\r\n\r\nexport class MainTarget extends BaseTarget {\r\n  constructor() {\r\n    super()\r\n  }\r\n\r\n  configureRules(configurator: WebpackConfigurator): void {\r\n    super.configureRules(configurator)\r\n\r\n    configurator.rules.push({\r\n      test: /\\.(png|jpg|gif)$/,\r\n      use: [\r\n        {\r\n          loader: \"url-loader\",\r\n          // to avoid any issues related to asar, embed any image up to 10MB as data url\r\n          options: configureFileLoader(\"imgs\", 10 * 1024 * 1024),\r\n        }\r\n      ]\r\n    })\r\n  }\r\n\r\n  async configurePlugins(configurator: WebpackConfigurator): Promise<void> {\r\n    await BaseTarget.prototype.configurePlugins.call(this, configurator)\r\n\r\n    if (configurator.isProduction) {\r\n      configurator.plugins.push(new DefinePlugin({\r\n        __static: `process.resourcesPath + \"/${configurator.staticSourceDirectory}\"`\r\n      }))\r\n\r\n      // // do not add for main dev (to avoid adding to hot update chunks), our main-hmr install it\r\n      // configurator.plugins.push(new BannerPlugin({\r\n      //   banner: 'require(\"source-map-support/source-map-support.js\").install();',\r\n      //   test: /\\.js$/,\r\n      //   raw: true,\r\n      //   entryOnly: true,\r\n      // }))\r\n      return\r\n    }\r\n\r\n    configurator.entryFiles.push(path.join(__dirname, \"../electron-main-hmr/main-hmr\"))\r\n    const devIndexFile = await getFirstExistingFile([\"index.dev.ts\", \"index.dev.js\"], path.join(configurator.projectDir, \"src/main\"))\r\n    if (devIndexFile != null) {\r\n      configurator.entryFiles.push(devIndexFile)\r\n    }\r\n  }\r\n}\r\n"],"mappings":"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"}
