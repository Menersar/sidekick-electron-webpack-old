{"version":3,"names":["_semver","data","require","createBabelLoader","configurator","presets","default","modules","targets","computeBabelEnvTarget","isRenderer","electronVersion","plugins","type","hasDependency","push","libraryName","styleLibraryName","addBabelItem","getMatchingDevDependencies","includes","excludes","loader","options","to","names","name","module","electron","nodeVersion","gte","node"],"sources":["../../src/configurators/js.ts"],"sourcesContent":["import { gte } from \"semver\"\r\nimport { WebpackConfigurator } from \"../main\"\r\n\r\nexport function createBabelLoader(configurator: WebpackConfigurator) {\r\n  // better to use require instead of just preset name to avoid babel resolving (in our test we set custom resolver - and only in case of explicit required it works)\r\n  const presets = [\r\n    [\r\n      require(\"@babel/preset-env\").default, {\r\n      modules: false,\r\n      targets: computeBabelEnvTarget(configurator.isRenderer, configurator.electronVersion),\r\n    }],\r\n  ]\r\n  const plugins = [\r\n    require(\"@babel/plugin-syntax-dynamic-import\").default,\r\n  ]\r\n\r\n  if (configurator.type !== \"main\" && configurator.hasDependency(\"element-ui\")) {\r\n    plugins.push([require(\"babel-plugin-component\"), {\r\n      libraryName: \"element-ui\",\r\n      styleLibraryName: \"theme-chalk\"\r\n    }])\r\n  }\r\n\r\n  addBabelItem(presets, configurator.getMatchingDevDependencies({\r\n    includes: [\"babel-preset-\", \"@babel/preset-\"],\r\n    excludes: [\"babel-preset-env\", \"@babel/preset-env\"],\r\n  }))\r\n  addBabelItem(plugins, configurator.getMatchingDevDependencies({\r\n    includes: [\"babel-plugin-\", \"@babel/plugin-\"],\r\n    excludes: [\"babel-plugin-syntax-dynamic-import\", \"@babel/plugin-syntax-dynamic-import\"],\r\n  }))\r\n\r\n  return {\r\n    loader: \"babel-loader\",\r\n    options: {\r\n      presets,\r\n      plugins\r\n    }\r\n  }\r\n}\r\n\r\nfunction addBabelItem(to: Array<any>, names: Array<string>) {\r\n  for (const name of names) {\r\n    const module = require(name)\r\n    to.push([module.default || module])\r\n  }\r\n}\r\n\r\nfunction computeBabelEnvTarget(isRenderer: boolean, electronVersion: string) {\r\n  if (isRenderer) {\r\n    return {\r\n      electron: electronVersion\r\n    }\r\n  }\r\n\r\n  let nodeVersion = \"7.4.0\"\r\n  if (gte(electronVersion, \"3.0.0\")) {\r\n    nodeVersion = \"10.2.0\"\r\n  }\r\n  else if (gte(electronVersion, \"2.0.0\")) {\r\n    nodeVersion = \"8.9.3\"\r\n  }\r\n  else if (gte(electronVersion, \"1.8.2\")) {\r\n    nodeVersion = \"8.2.1\"\r\n  }\r\n  else if (gte(electronVersion, \"1.7.3\")) {\r\n    nodeVersion = \"7.9.0\"\r\n  }\r\n\r\n  return {\r\n    node: nodeVersion\r\n  }\r\n}\r\n"],"mappings":";;;;;;AAAA,SAAAA,QAAA;EAAA,MAAAC,IAAA,GAAAC,OAAA;EAAAF,OAAA,YAAAA,CAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAGM,SAAUE,iBAAiBA,CAACC,YAAiC;EACjE;EACA,MAAMC,OAAO,GAAG,CACd,CACEH,OAAO,CAAC,mBAAmB,CAAC,CAACI,OAAO,EAAE;IACtCC,OAAO,EAAE,KAAK;IACdC,OAAO,EAAEC,qBAAqB,CAACL,YAAY,CAACM,UAAU,EAAEN,YAAY,CAACO,eAAe;GACrF,CAAC,CACH;EACD,MAAMC,OAAO,GAAG,CACdV,OAAO,CAAC,qCAAqC,CAAC,CAACI,OAAO,CACvD;EAED,IAAIF,YAAY,CAACS,IAAI,KAAK,MAAM,IAAIT,YAAY,CAACU,aAAa,CAAC,YAAY,CAAC,EAAE;IAC5EF,OAAO,CAACG,IAAI,CAAC,CAACb,OAAO,CAAC,wBAAwB,CAAC,EAAE;MAC/Cc,WAAW,EAAE,YAAY;MACzBC,gBAAgB,EAAE;KACnB,CAAC,CAAC;;EAGLC,YAAY,CAACb,OAAO,EAAED,YAAY,CAACe,0BAA0B,CAAC;IAC5DC,QAAQ,EAAE,CAAC,eAAe,EAAE,gBAAgB,CAAC;IAC7CC,QAAQ,EAAE,CAAC,kBAAkB,EAAE,mBAAmB;GACnD,CAAC,CAAC;EACHH,YAAY,CAACN,OAAO,EAAER,YAAY,CAACe,0BAA0B,CAAC;IAC5DC,QAAQ,EAAE,CAAC,eAAe,EAAE,gBAAgB,CAAC;IAC7CC,QAAQ,EAAE,CAAC,oCAAoC,EAAE,qCAAqC;GACvF,CAAC,CAAC;EAEH,OAAO;IACLC,MAAM,EAAE,cAAc;IACtBC,OAAO,EAAE;MACPlB,OAAO;MACPO;;GAEH;AACH;AAEA,SAASM,YAAYA,CAACM,EAAc,EAAEC,KAAoB;EACxD,KAAK,MAAMC,IAAI,IAAID,KAAK,EAAE;IACxB,MAAME,MAAM,GAAGzB,OAAO,CAACwB,IAAI,CAAC;IAC5BF,EAAE,CAACT,IAAI,CAAC,CAACY,MAAM,CAACrB,OAAO,IAAIqB,MAAM,CAAC,CAAC;;AAEvC;AAEA,SAASlB,qBAAqBA,CAACC,UAAmB,EAAEC,eAAuB;EACzE,IAAID,UAAU,EAAE;IACd,OAAO;MACLkB,QAAQ,EAAEjB;KACX;;EAGH,IAAIkB,WAAW,GAAG,OAAO;EACzB,IAAI,IAAAC,aAAG,EAACnB,eAAe,EAAE,OAAO,CAAC,EAAE;IACjCkB,WAAW,GAAG,QAAQ;GACvB,MACI,IAAI,IAAAC,aAAG,EAACnB,eAAe,EAAE,OAAO,CAAC,EAAE;IACtCkB,WAAW,GAAG,OAAO;GACtB,MACI,IAAI,IAAAC,aAAG,EAACnB,eAAe,EAAE,OAAO,CAAC,EAAE;IACtCkB,WAAW,GAAG,OAAO;GACtB,MACI,IAAI,IAAAC,aAAG,EAACnB,eAAe,EAAE,OAAO,CAAC,EAAE;IACtCkB,WAAW,GAAG,OAAO;;EAGvB,OAAO;IACLE,IAAI,EAAEF;GACP;AACH"}
